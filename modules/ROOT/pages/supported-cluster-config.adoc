= Supported Configurations for Anypoint Platform PCE
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]
:page-aliases: prereq-env.adoc

To ensure platform performance, stability, and high availability, Anypoint Platform Private Cloud Edition (Anypoint Platform PCE) supports two network configurations: 4-node and 7-node.

To ensure high availability and performance, each node must run on its own server in both configurations. If you are using a virtual machine to host the nodes, you must ensure that each VM node is running on a separate physical server.

There are 2 components of PCE:

- Anypoint Platform Core

- Monitoring Center Add-On

== Anypoint Platform Core

=== 4-Node Configuration

Three is the minimum number of nodes that can enable high-availability and failover. In this configuration, each node hosts the platform applications and services. You must configure a load balancer to use round-robin distribution of traffic among each of the four nodes.

image::prereqs-priv-cloud-3-node.png[3-node Configuration]

Three of the nodes host an instance of the database and object store. Hosting the database and object store enables persistence but requires larger minimum disk and memory requirements. Although three of the nodes contain a database, only one database is used as the master. Applications on each node write to this database only. The other two database instances are hot standby instances of the master database that take over as the master database in case of failure.

==== Environment Limitations

You must understand and adhere to the following recommendations and limitations when installing Anypoint Platform PCE and deploying apps.

These limitations are based on a 4-node environment consisting of 4 nodes of 8 cores and 32GB RAM.

**** Runtime management

***** Maximum number of servers: 500
***** Maximum number of servers per server group: 20
***** Maximum servers per cluster: 8

**** Applications per environment 

***** Mule applications under management per environment:
****** Recommended: Under 200
****** Maximum: 500

***** Mule runtime engines under management
****** Maximum: 500 single Mule runtime engines (or 250 Mule runtime clusters, consisting of 2 Mule runtime engines per cluster)

***** Mule applications per Mule runtime engine 
****** Maximum number of apps: 100
****** Recommended number of apps: fewer than 25

**** API management

***** Limit each 2.1.0 cluster (3 nodes, 8 cores) management plane to 5000 APIs under management in which:

****** A single API implementation with one policy counts as 0.5.
****** A single clustered proxy with up to 5 policies counts as 1.
****** All runtimes are polling every 60 seconds.

**** Access Manager

***** Maximum of 50 business groups

**** Exchange

***** Maximum Exchange assets: 60,000
***** Maximum file size when publishing asset through UI: 5 MB 
***** Maximum uncompressed file size: 50 MB 
***** Maximum file size when publishing asset through Maven: 200 MB
***** Maximum number of dependencies for a single asset: 100
***** Maximum icon size: 2 MB
***** Maximum number of resources (attachments) per asset portal: 100
***** Maximum resource size for attachments to the asset portal: 2 MB
***** Maximum indexable asset content for RAML or asset portal: 1 MB
***** Maximum number of categories per organization: 500
***** Maximum number of custom configurations per organization: 500
***** Maximum number of pages in a portal: 50
***** Maximum length of page name: 128 characters
***** Maximum review title length: 30 characters
***** Maximum review text length: 2048 characters

The 1 MB maximum indexable asset content for RAML or asset portal means that if your portal has more than 1MB in text, only the first 1MB will be indexed, and if your portal has more than 1 MB in RAML specifications, only the first 1 MB will be indexed.

=== 7-Node Configuration

In the 7-node configuration, four nodes are dedicated to hosting platform applications and services. The other three nodes host the database and object store instances. Although each node contains a database, only one of the database nodes is used as the master. Applications on each node write to this database only. The other two database instances are hot standby instances of the master database that take over as the master database in case of failure.

image::prereqs-priv-cloud-6-node.png[6-node Configuration]

You must configure a load balancer to use round-robin distribution of traffic among all of the nodes in your cluster.

==== Environment Limitations

You must understand and adhere to the following recommendations and limitations when installing Anypoint Platform PCE and deploying apps.

These limitations are based on a 7-node environment consisting of 7 nodes of 8 cores and 32GB RAM.

**** Runtime management

***** Maximum number of servers: 1000
***** Maximum number of servers per server group: 20
***** Maximum servers per cluster: 8

**** Applications per environment 

***** Mule applications under management:
****** Recommended: around 200
****** Maximum: 500

***** Mule runtime engines under management
****** Maximum: 1000 single Mule runtime engines (or 500 Mule runtime clusters, consisting of 2 Mule runtime engines per cluster)

***** Mule applications per Mule runtime engine
****** Maximum number of apps: 50 
****** Recommended number of apps: fewer than 25

**** API management

***** Limit each 2.1.0 cluster management plane to 20000 (6 nodes, 16 cores) APIs under management and 10000 (6 nodes 8 cores), 
in which:

****** A single API implementation with one policy counts as 0.5.
****** A single clustered proxy with up to 5 policies counts as 1.
****** All runtimes are polling every 60 seconds. 

**** Access Manager

***** Limit to 100 business groups

**** Exchange

***** Maximum Exchange assets: 60,000
***** Maximum file size when publishing asset through UI: 5 MB 
***** Maximum uncompressed file size: 50 MB 
***** Maximum file size when publishing asset through Maven: 200 MB
***** Maximum number of dependencies for a single asset: 100
***** Maximum icon size: 2 MB
***** Maximum number of resources (attachments) per asset portal: 100
***** Maximum resource size for attachments to the asset portal: 2 MB
***** Maximum indexable asset content for RAML or asset portal: 1 MB
***** Maximum number of categories per organization: 500
***** Maximum number of custom configurations per organization: 500
***** Maximum number of pages in a portal: 50
***** Maximum length of page name: 128 characters
***** Maximum review title length: 30 characters
***** Maximum review text length: 2048 characters

The 1 MB maximum indexable asset content for RAML or asset portal means that if your portal has more than 1MB in text, only the first 1MB will be indexed, and if your portal has more than 1 MB in RAML specifications, only the first 1 MB will be indexed.

== Monitoring Center Add-On

=== 3-Node Configuration

Monitoring Center can be enabled as an additional add-on.

Monitoring Center runs on 3 nodes separate from the nodes that run the Anypoint Platform Core.

These nodes host the stateful and stateless services that compose Monitoring Center.
