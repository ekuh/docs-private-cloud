= Configure Backup and Restore for Anypoint Private Cloud
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]

== To Update the InfluxDB License

If the influx license is updated, it needs to be added to the secret in the default namespace and then ensure it is running in the pods


1. Encode the new key

----
echo -n "new-license-uuid-key" | base64
----

2. Edit the secret

----
kubectl edit secret/influxdb-license
----

3. As the license is only added to the helm chart/configmap on deploy, the config map needs to be updated:

----
kubectl edit configmap/dias-prov-k8s-am-influxdb-comp-data -n dias
----

4. Replace the key in influxdb.com (probably line 29)

----
\ license-key = \"old-license-uuid-key\"
----

with the new key

----
\ license-key = \"new-license-uuid-key\"
----

5. Then restart the pods

----
kubectl delete pod dias-prov-k8s-am-influxdb-comp-data-0 -n dias
kubectl delete pod dias-prov-k8s-am-influxdb-comp-data-1 -n dias
----

